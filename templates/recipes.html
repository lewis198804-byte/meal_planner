<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
</head>
  <body>
    <section>
        <header >
            <div class="card text-center mt-5 mx-auto" style="width:40em">
                <h1>Meal Planner</h1>
            </div>
        </header>
    </section>
    <section>
        <div class="mt-5 mx-auto" style="width:70em">
            <table id="recipe_table" class="text-center table table-striped">

            </table>
        </div>
        
    </section>
   
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  
    <script>
        const recipe_table = document.getElementById("recipe_table");
        loadRecipes();

        async function loadRecipes(){
            try {
                const response = await fetch('/get_recipes');
                const recipes = await response.json();
                tableContents = ""
                if (recipes.length == 0){
                    tableContents = "<tr><td>No Recipes in the database</td></tr>"
                }
                
                recipes.forEach(element => {
                    tableContents += "<tr><td>"+element[1]+"</td><td><button onclick='deleteRecipe("+element[0]+")'><i class='bi bi-trash3'></i></button></td></tr>"
                });
                recipe_table.innerHTML = tableContents
                console.log(recipes);
            }
            catch(error){
                console.log(error);
            }
        }


        async function deleteRecipe(recipe_id){
            try {
                const response = await fetch('/del_recipe/'+recipe_id);
                const del_response = await response

                if (del_response.ok){
                    console.log(response)
                    loadRecipes()
                }
            }
            catch(error){
                console.log(error)
            }
        }
    </script>




</body>
</html>